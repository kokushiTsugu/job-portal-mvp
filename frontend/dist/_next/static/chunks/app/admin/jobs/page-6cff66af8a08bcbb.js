(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[711],{3728:(e,r,s)=>{Promise.resolve().then(s.bind(s,7957))},7957:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>o});var a=s(5155),t=s(2115),l=s(6046);function o(){let e=(0,l.useRouter)(),[r,s]=(0,t.useState)([]),[o,n]=(0,t.useState)(""),[c,d]=(0,t.useState)(!1),[i,h]=(0,t.useState)(""),[u,m]=(0,t.useState)(""),[b,x]=(0,t.useState)(""),[p,j]=(0,t.useState)("published"),g=async()=>{n("");try{let r=localStorage.getItem("adminToken");if(!r){e.replace("/admin/login");return}let a=await fetch("http://localhost:8080/admin/jobs",{headers:{Authorization:"Bearer ".concat(r)}});if(!a.ok){let e=await a.json();throw Error(e.message||"求人リスト取得失敗")}let t=await a.json();s(t.jobs||[])}catch(e){console.error(e),n("Error: "+e.message)}};(0,t.useEffect)(()=>{g()},[]);let N=async e=>{e.preventDefault(),n("");try{let e=localStorage.getItem("adminToken");if(!e)return;let r=await fetch("http://localhost:8080/admin/jobs",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({title:i,description:u,status:p,company:b})}),s=await r.json();if(!r.ok)throw Error(s.message||"求人作成に失敗しました");h(""),m(""),x(""),j("published"),d(!1),g()}catch(e){console.error(e),n("Error: "+e.message)}},f=async e=>{if(n(""),confirm("本当に削除しますか？"))try{let r=localStorage.getItem("adminToken");if(!r)return;let s=await fetch("http://localhost:8080/admin/jobs/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r)}}),a=await s.json();if(!s.ok)throw Error(a.message||"求人削除に失敗しました");g()}catch(e){console.error(e),n("Error: "+e.message)}},y=r=>{e.push("/admin/jobs/".concat(r,"/edit"))};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"求人管理"}),o&&(0,a.jsx)("p",{className:"text-red-600 font-semibold",children:o}),(0,a.jsx)("button",{onClick:()=>d(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded shadow",children:"新規求人を追加"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full mt-4 border border-gray-200",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-100 border-b border-gray-300",children:[(0,a.jsx)("th",{className:"p-2 border-r border-gray-300",children:"タイトル"}),(0,a.jsx)("th",{className:"p-2 border-r border-gray-300",children:"会社名"}),(0,a.jsx)("th",{className:"p-2 border-r border-gray-300",children:"ステータス"}),(0,a.jsx)("th",{className:"p-2 border-r border-gray-300",children:"応募数"}),(0,a.jsx)("th",{className:"p-2",children:"操作"})]})}),(0,a.jsxs)("tbody",{children:[r.map(e=>{var r;return(0,a.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,a.jsx)("td",{className:"p-2 border-r border-gray-300",children:e.title}),(0,a.jsx)("td",{className:"p-2 border-r border-gray-300",children:e.company||"（未入力）"}),(0,a.jsx)("td",{className:"p-2 border-r border-gray-300",children:e.status}),(0,a.jsx)("td",{className:"p-2 border-r border-gray-300",children:null!==(r=e.applicationCount)&&void 0!==r?r:0}),(0,a.jsxs)("td",{className:"p-2 whitespace-nowrap",children:[(0,a.jsx)("button",{onClick:()=>y(e._id),className:"text-blue-600 hover:underline mr-3",children:"編集"}),(0,a.jsx)("button",{onClick:()=>f(e._id),className:"text-red-600 hover:underline",children:"削除"})]})]},e._id)}),0===r.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:5,className:"p-4 text-center text-gray-500",children:"求人がありません"})})]})]})}),c&&(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded shadow w-96 relative",children:[(0,a.jsx)("button",{onClick:()=>d(!1),className:"absolute top-2 right-2 text-gray-600 font-bold",children:"\xd7"}),(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"求人を新規作成"}),(0,a.jsxs)("form",{onSubmit:N,className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-1",children:"タイトル"}),(0,a.jsx)("input",{type:"text",className:"w-full border p-2",value:i,onChange:e=>h(e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-1",children:"会社名"}),(0,a.jsx)("input",{type:"text",className:"w-full border p-2",value:b,onChange:e=>x(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-1",children:"ステータス"}),(0,a.jsxs)("select",{className:"w-full border p-2",value:p,onChange:e=>j(e.target.value),children:[(0,a.jsx)("option",{value:"published",children:"published"}),(0,a.jsx)("option",{value:"draft",children:"draft"}),(0,a.jsx)("option",{value:"closed",children:"closed"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-1",children:"説明"}),(0,a.jsx)("textarea",{className:"w-full border p-2",rows:3,value:u,onChange:e=>m(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>d(!1),className:"bg-gray-300 px-4 py-2 rounded",children:"キャンセル"}),(0,a.jsx)("button",{type:"submit",className:"bg-indigo-600 text-white px-4 py-2 rounded",children:"作成"})]})]})]})})]})}},6046:(e,r,s)=>{"use strict";var a=s(6658);s.o(a,"useParams")&&s.d(r,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(r,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(r,{useRouter:function(){return a.useRouter}})}},e=>{var r=r=>e(e.s=r);e.O(0,[441,517,358],()=>r(3728)),_N_E=e.O()}]);